/*
    날짜 : 2025/07/15
    이름 : 이수연
    내용 : 3장 SQL 고습
*/

-- 실습하기 3-1. 테이블 생성 및 데이터 입력
CREATE TABLE EMP(
    EMPNO number(4)primary key,
    NAME varchar2(20)not null,
    GENDER char(1)not null,
    JOB varchar(20)not null,
    DEPNO number(2),
    REGDATE date not null
);

CREATE TABLE DEPT(
    DEPTNO number(2),
    DNAME varchar2(20),
    DTEL varchar2(12)
);

CREATE TABLE SALE(
    NO number generated by default as identity primary key,
    EMPNO number(4) not null,
    YEAR number(4) not null,
    MONTH number(2)not null,
    PRICE number(10)
);

// 직원 테이블 데이터 입력
INSERT INTO EMP VALUES (1001, '김유신', 'M', '사원', 10, SYSDATE);
INSERT INTO EMP VALUES (1002, '김춘추', 'M', '대리', 20, SYSDATE);
INSERT INTO EMP VALUES (1003, '장보고', 'M', '과장', 10, SYSDATE);
INSERT INTO EMP VALUES (1004, '강감찬', 'M', '부장', 30, SYSDATE);
INSERT INTO EMP VALUES (1005, '신사임당', 'F', '대리', 20, SYSDATE);
INSERT INTO EMP VALUES (1006, '이황', 'M', '사원', 40, SYSDATE);
INSERT INTO EMP VALUES (1007, '이이', 'M', '과장', 20, SYSDATE);
INSERT INTO EMP VALUES (1008, '이순신', 'M', '사원', NULL, SYSDATE);
INSERT INTO EMP VALUES (1009, '허난설헌', 'F', '사원', NULL, SYSDATE);
INSERT INTO EMP VALUES (1010, '정약용', 'M', '대리', 50, SYSDATE);
// 부서 테이블 데이터 입력
INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (10, '영업1부', '051-511-1000');
INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (20, '영업2부', '051-511-2000');
INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (30, '영업3부', '051-511-3000');
INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (40, '영업4부', '051-511-4000');
INSERT INTO DEPT (DEPTNO, DNAME, DTEL) VALUES (50, '영업지원부', '051-511-5000');
// 매출 테이블 데이터 입력
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1001, 2023, 1, 98100);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1002, 2023, 1, 136000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1003, 2023, 1, 80000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1004, 2023, 1, 78000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1005, 2023, 1, NULL);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1001, 2023, 2, 23500);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1002, 2023, 2, 126000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1003, 2023, 2, 18500);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1005, 2023, 2, 19000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1010, 2023, 2, 53000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1001, 2024, 1, 24000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1002, 2024, 1, 109000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1003, 2024, 1, 80000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1004, 2024, 1, NULL);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1007, 2024, 1, 24000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1002, 2024, 2, 160000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1003, 2024, 2, 101000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1004, 2024, 2, 43000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1005, 2024, 2, 24000);
INSERT INTO SALE (EMPNO, YEAR, MONTH, PRICE) VALUES (1006, 2024, 2, 109000);

SELECT * FROM EMP WHERE name = '김유신';
SELECT * FROM EMP WHERE job = '사원' and depno = 10;
SELECT * FROM EMP WHERE job = '차장' OR depno = 10;
SELECT * FROM EMP WHERE name != '김춘추';
SELECT * FROM EMP WHERe name <> '김춘추';
SELECT * FROM EMP WHEre job = '사원' and depno =10;
SELECT * FROM EMP WHERE job = '사원' or job = '대리';
SELECT * FROM EMP WHERE job in('사원', '대리');
SELECT * FROM EMP WHERE depno in(101, 102, 103);
SELECT * FROM EMP WHERE name like '김%';
SELECT * FROM EMP WHERE name like '%신';
SELECT * FROM EMP WHERE name like '김__';
SELECT * FROM EMP WHERE name like '이_';
SELECT * FROM EMP WHERE name like '_순%';
SELECT * FROM EMP WHERE hp like '010-1111%'; //없는 열
SELECT * FROM EMP WHERE depno is null;
SELECT * FROM EMP WHERE depno is not null;
SELECT * FROM EMP WHERE empno >= 1005;
SELECT * FROM DEPT WHERE deptno = 10;
SELECT * FROM DEPT WHERE dname = '영업지원부';
SELECT * FROM DEPT WHERE dtel like '%30%';
SELECT * FROM DEPT WHERE deptno in (10, 30);
SELECT * FROM DEPT WHERE dname like '영업__';
SELECT * FROM SALE WHERE PRICE > 50000;
SELECT * FROM SALE WHERE price >= 50000 and price <100000 and month =1;
SELECT * FROM SALE WHERE price between 50000 and 100000;
SELECT * FROM SALE WHERE year = 2024;
SELECT * FROM SALE WHERE year = 2024 and month = 2;
SELECT * FROM SALE WHERE month in(1,2);

-- 실습하기 2-2
select * from sale order by price;
select * from sale order by PRICE asc; // ASC 는 작은 값부터 큰 수로 나열
select * from sale order by price desc; //DESC 는 큰 갑부터 작은 수로 나열

select * from emp order by name;
SELECT * FROM EMP ORDER BY NAME DESC; // 큰 값부터 작은 값 순으로 나열
select * from emp order by rdate asc;

SELECT * FROM SALE WHERE PRICE > 50000 ORDER BY PRICE DESC;
SELECT * FROM SALE
    WHERE PRICE > 50000
    ORDER BY YEAR DESC, MONTH, PRICE DESC; // 5만원보다 크고, 연도 순/월 순/가격 순 순서대로 나열

SELECT * FROM SALE FETCH FIRST 3 ROWS ONLY; // FETCH 개수제한 FIRST 처음부터 3ROW 3행
SELECT * FROM SALE OFFSET 0 ROW FETCH NEXT 3 ROWS ONLY; //윗 줄이랑 같음. 단, OFFSET 0은 0부터 시작해서 3행.
SELECT * FROM SALE OFFSET 1 ROW FETCH NEXT 2 ROWS ONLY; //2번줄부터(OFFSET) 2개의 행(2 ROWS)까지 출력.
SELECT * FROM SALE OFFSET 5 ROW FETCH NEXT 3 ROWS ONLY; //6번 부터 3개. 6,7,8번 데이터가 출력됨.
SELECT * FROM SALE ORDER BY PRICE DESC OFFSET 3 ROWS FETCH NEXT 5 ROWS ONLY; //

SELECT * FROM SALE
    WHERE PRICE < 50000
    ORDER BY PRICE DESC
    FETCH FIRST 3 ROWS ONLY;
    
SELECT * FROM SALE
    WHERE PRICE > 50000
    ORDER BY YEAR DESC, MONTH, PRICE DESC
    FETCH FIRST 5 ROWS ONLY;
 
SELECT DISTINCT DEPNO FROM EMP;
SELECT DISTINCT JOB, DEPNO FROM EMP;

SELECT EMPNO AS 사번, NAME AS 이름, GENDER "성 별" FROM EMP;
SELECT EMPNO E, NAME N, GENDER G FROM EMP;
